# 실시간 협업 시스템 설계

실시간 협업 시스템은 여러 사용자가 문서, 스프레드시트, 디자인 캔버스, 코드 에디터와 같은 공유 리소스와 동시에 상호 작용할 수 있게 합니다. 이러한 시스템은 네트워크 지연 및 동시 편집에도 불구하고 응답성 있는 사용자 경험을 제공하면서 일관성을 유지해야 합니다.

아키텍처는 클라이언트 구성 요소(사용자 상호 작용 및 로컬 상태 처리), 동기화 서비스(사용자 간 변경 사항 전파), 지속성 계층(문서 상태 및 기록 저장), 존재 서비스(활성 사용자 및 활동 추적)로 구성됩니다.

충돌 해결 접근 방식으로는 동시 작업을 변환하여 수렴을 달성하는 Operational Transformation(OT); 실행 순서에 관계없이 작업이 교환 가능하도록 설계하는 Conflict-free Replicated Data Types(CRDT); 동시 편집을 직렬화할 수 있는 간단한 경우를 위한 잠금 메커니즘 등이 있습니다.

동기화 프로토콜은 일반적으로 양방향, 저지연 통신을 위해 WebSocket이나 Server-Sent Events를 사용합니다. 서버는 중앙 조정자 역할을 하여 변경 사항을 검증하고, 충돌을 해결하며, 연결된 클라이언트에 업데이트를 브로드캐스팅합니다. 장애 허용성을 위해 클라이언트는 일시적인 연결 해제를 처리하기 위한 보류 중인 작업 큐를 유지합니다.

상태 관리는 네트워크 트래픽을 최소화하기 위한 효율적인 변경 표현이 필요합니다. 문자 단위 변경은 너무 세분화되고, 문서 수준 변경은 너무 거칠습니다. 대부분의 시스템은 페이로드 크기를 줄이기 위해 최적화된 델타 인코딩과 함께 구조적 변경(단락, 셀, 객체)을 사용합니다.

확장성 고려 사항으로는 문서 파티셔닝(큰 문서를 관리 가능한 섹션으로 분리), 선택적 브로드캐스팅(영향을 받는 섹션을 보고 있는 사용자에게만 변경 사항 전송), 대규모 사용자 수를 위한 계층적 서버 아키텍처 등이 있습니다. 클라우드 기반 구현은 종종 서버 인스턴스 간에 업데이트를 분산하기 위해 발행-구독 시스템을 사용합니다.

협업 인식 기능으로는 사용자 존재(누가 온라인인지), 활동 표시기(누가 무엇을 편집 중인지), 커서/선택(다른 사람들이 어디서 작업 중인지), 귀속(누가 특정 변경을 했는지) 등이 표시됩니다. 이러한 신호는 사용자가 명시적인 의사소통 없이도 자연스럽게 조정할 수 있도록 돕습니다.

지속성 전략으로는 저널링(모든 작업 기록), 스냅샷(주기적인 완전한 상태 캡처), 또는 두 가지의 조합을 통해 문서 발전을 캡처합니다. 이력 추적을 통해 시간 여행 디버깅, 버전 비교, 문서 개발의 감사 추적이 가능합니다.

보안 모델은 협업과 접근 제어 사이의 균형을 맞추어야 하며, 일반적으로 사용자/그룹 기반 권한 부여와 민감한 콘텐츠를 위한 선택적인 요소 수준 제한이 있는 문서 수준 권한을 구현합니다.